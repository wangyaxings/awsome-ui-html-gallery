<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¼€æºåè®®è®°å½•ç»Ÿè®¡è¡¨æ ¼</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5em;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            align-items: center;
        }

        button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .search-container {
            position: relative;
            flex: 1;
            min-width: 300px;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #e0e6ed;
            border-radius: 25px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
        }

        .table-container {
            overflow-x: auto;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            background: white;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            white-space: nowrap;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 13px;
        }

        tr:hover {
            background: linear-gradient(90deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            transform: scale(1.001);
            transition: all 0.2s ease;
        }

        .license-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .mit { background: #e8f5e8; color: #2e7d32; }
        .apache { background: #fff3e0; color: #ef6c00; }
        .gpl { background: #fce4ec; color: #c2185b; }
        .bsd { background: #e3f2fd; color: #1976d2; }
        .mozilla { background: #f3e5f5; color: #7b1fa2; }

        .risk-high { background: #ffebee; color: #c62828; }
        .risk-medium { background: #fff8e1; color: #f57c00; }
        .risk-low { background: #e8f5e8; color: #388e3c; }

        .url-link {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .url-link:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid rgba(102, 126, 234, 0.2);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .stat-number {
            font-size: 2em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #6c757d;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 12px;
        }

        .add-form {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            margin-bottom: 5px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 13px;
        }

        select, input[type="text"], input[type="url"], input[type="date"], textarea {
            padding: 10px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 13px;
            transition: all 0.3s ease;
        }

        select:focus, input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .export-section {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            border-radius: 15px;
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”“ å¼€æºåè®®è®°å½•ç»Ÿè®¡è¡¨æ ¼</h1>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalCount">0</div>
                <div class="stat-label">æ€»é¡¹ç›®æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="licenseTypes">0</div>
                <div class="stat-label">è®¸å¯è¯ç±»å‹</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="highRiskCount">0</div>
                <div class="stat-label">é«˜é£é™©é¡¹ç›®</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="activeProjects">0</div>
                <div class="stat-label">æ´»è·ƒé¡¹ç›®</div>
            </div>
        </div>

        <div class="controls">
            <button onclick="toggleAddForm()">â• æ·»åŠ é¡¹ç›®</button>
            <button onclick="exportToExcel()">ğŸ“Š å¯¼å‡ºExcel</button>
            <button onclick="importSampleData()">ğŸ“¥ åŠ è½½ç¤ºä¾‹æ•°æ®</button>
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="ğŸ” æœç´¢è½¯ä»¶åç§°ã€è®¸å¯è¯ç±»å‹ã€å‚å•†..." onkeyup="filterTable()">
            </div>
        </div>

        <div id="addForm" class="add-form">
            <h3>æ·»åŠ æ–°é¡¹ç›®</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label for="software">è½¯ä»¶åç§° *</label>
                    <input type="text" id="software" required>
                </div>
                <div class="form-group">
                    <label for="version">ç‰ˆæœ¬å·</label>
                    <input type="text" id="version">
                </div>
                <div class="form-group">
                    <label for="licenseType">è®¸å¯è¯ç±»å‹ *</label>
                    <select id="licenseType" required>
                        <option value="">è¯·é€‰æ‹©...</option>
                        <option value="MIT">MIT</option>
                        <option value="Apache-2.0">Apache 2.0</option>
                        <option value="GPL-3.0">GPL 3.0</option>
                        <option value="GPL-2.0">GPL 2.0</option>
                        <option value="BSD-3-Clause">BSD 3-Clause</option>
                        <option value="BSD-2-Clause">BSD 2-Clause</option>
                        <option value="Mozilla-2.0">Mozilla 2.0</option>
                        <option value="LGPL-3.0">LGPL 3.0</option>
                        <option value="ISC">ISC</option>
                        <option value="Unlicense">Unlicense</option>
                        <option value="Custom">è‡ªå®šä¹‰</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="licenseUrl">è®¸å¯è¯URL</label>
                    <input type="url" id="licenseUrl">
                </div>
                <div class="form-group">
                    <label for="copyright">ç‰ˆæƒä¿¡æ¯</label>
                    <input type="text" id="copyright">
                </div>
                <div class="form-group">
                    <label for="vendor">å‚å•†/ä½œè€…</label>
                    <input type="text" id="vendor">
                </div>
                <div class="form-group">
                    <label for="projectUrl">é¡¹ç›®åœ°å€</label>
                    <input type="url" id="projectUrl">
                </div>
                <div class="form-group">
                    <label for="usage">ä½¿ç”¨æ–¹å¼</label>
                    <select id="usage">
                        <option value="">è¯·é€‰æ‹©...</option>
                        <option value="Direct Dependency">ç›´æ¥ä¾èµ–</option>
                        <option value="Transitive Dependency">é—´æ¥ä¾èµ–</option>
                        <option value="Development Dependency">å¼€å‘ä¾èµ–</option>
                        <option value="Runtime Dependency">è¿è¡Œæ—¶ä¾èµ–</option>
                        <option value="Static Link">é™æ€é“¾æ¥</option>
                        <option value="Dynamic Link">åŠ¨æ€é“¾æ¥</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="riskLevel">é£é™©è¯„çº§</label>
                    <select id="riskLevel">
                        <option value="">è¯·é€‰æ‹©...</option>
                        <option value="Low">ä½é£é™©</option>
                        <option value="Medium">ä¸­é£é™©</option>
                        <option value="High">é«˜é£é™©</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="lastUpdated">æœ€åæ›´æ–°</label>
                    <input type="date" id="lastUpdated">
                </div>
                <div class="form-group">
                    <label for="status">é¡¹ç›®çŠ¶æ€</label>
                    <select id="status">
                        <option value="">è¯·é€‰æ‹©...</option>
                        <option value="Active">æ´»è·ƒ</option>
                        <option value="Maintenance">ç»´æŠ¤ä¸­</option>
                        <option value="Deprecated">å·²å¼ƒç”¨</option>
                        <option value="Archived">å·²å½’æ¡£</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="category">åˆ†ç±»</label>
                    <select id="category">
                        <option value="">è¯·é€‰æ‹©...</option>
                        <option value="Framework">æ¡†æ¶</option>
                        <option value="Library">åº“</option>
                        <option value="Tool">å·¥å…·</option>
                        <option value="Database">æ•°æ®åº“</option>
                        <option value="UI Component">UIç»„ä»¶</option>
                        <option value="Testing">æµ‹è¯•</option>
                        <option value="Security">å®‰å…¨</option>
                        <option value="Networking">ç½‘ç»œ</option>
                        <option value="Other">å…¶ä»–</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="description">æè¿°</label>
                <textarea id="description" placeholder="é¡¹ç›®æè¿°ã€ç”¨é€”è¯´æ˜ç­‰..."></textarea>
            </div>
            <div class="form-group">
                <label for="notes">å¤‡æ³¨</label>
                <textarea id="notes" placeholder="å…¶ä»–å¤‡æ³¨ä¿¡æ¯..."></textarea>
            </div>
            <button onclick="addProject()">âœ… æ·»åŠ é¡¹ç›®</button>
            <button onclick="toggleAddForm()">âŒ å–æ¶ˆ</button>
        </div>

        <div class="table-container">
            <table id="projectTable">
                <thead>
                    <tr>
                        <th>åºå·</th>
                        <th>è½¯ä»¶åç§°</th>
                        <th>ç‰ˆæœ¬å·</th>
                        <th>è®¸å¯è¯ç±»å‹</th>
                        <th>è®¸å¯è¯URL</th>
                        <th>ç‰ˆæƒä¿¡æ¯</th>
                        <th>å‚å•†/ä½œè€…</th>
                        <th>é¡¹ç›®åœ°å€</th>
                        <th>ä½¿ç”¨æ–¹å¼</th>
                        <th>é£é™©è¯„çº§</th>
                        <th>æœ€åæ›´æ–°</th>
                        <th>é¡¹ç›®çŠ¶æ€</th>
                        <th>åˆ†ç±»</th>
                        <th>æè¿°</th>
                        <th>å¤‡æ³¨</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>
        </div>

        <div class="export-section">
            <h3>ğŸ“‹ ä½¿ç”¨è¯´æ˜</h3>
            <p>1. ç‚¹å‡»"æ·»åŠ é¡¹ç›®"æŒ‰é’®æ·»åŠ æ–°çš„å¼€æºè½¯ä»¶è®°å½•</p>
            <p>2. ä½¿ç”¨æœç´¢æ¡†å¿«é€ŸæŸ¥æ‰¾ç‰¹å®šé¡¹ç›®</p>
            <p>3. ç‚¹å‡»"å¯¼å‡ºExcel"ç”Ÿæˆå®Œæ•´çš„ç»Ÿè®¡æŠ¥è¡¨</p>
            <p>4. æ”¯æŒè®°å½•è®¸å¯è¯åˆè§„æ€§ã€é£é™©è¯„ä¼°ç­‰å…³é”®ä¿¡æ¯</p>
        </div>
    </div>

    <script>
        let projects = [];
        let currentEditId = null;

        function toggleAddForm() {
            const form = document.getElementById('addForm');
            form.style.display = form.style.display === 'none' || form.style.display === '' ? 'block' : 'none';
            
            if (form.style.display === 'block') {
                clearForm();
                currentEditId = null;
            }
        }

        function clearForm() {
            document.getElementById('software').value = '';
            document.getElementById('version').value = '';
            document.getElementById('licenseType').value = '';
            document.getElementById('licenseUrl').value = '';
            document.getElementById('copyright').value = '';
            document.getElementById('vendor').value = '';
            document.getElementById('projectUrl').value = '';
            document.getElementById('usage').value = '';
            document.getElementById('riskLevel').value = '';
            document.getElementById('lastUpdated').value = '';
            document.getElementById('status').value = '';
            document.getElementById('category').value = '';
            document.getElementById('description').value = '';
            document.getElementById('notes').value = '';
        }

        function addProject() {
            const software = document.getElementById('software').value;
            const licenseType = document.getElementById('licenseType').value;
            
            if (!software || !licenseType) {
                alert('è¯·å¡«å†™å¿…å¡«å­—æ®µï¼šè½¯ä»¶åç§°å’Œè®¸å¯è¯ç±»å‹');
                return;
            }

            const project = {
                id: currentEditId || Date.now(),
                software: software,
                version: document.getElementById('version').value,
                licenseType: licenseType,
                licenseUrl: document.getElementById('licenseUrl').value,
                copyright: document.getElementById('copyright').value,
                vendor: document.getElementById('vendor').value,
                projectUrl: document.getElementById('projectUrl').value,
                usage: document.getElementById('usage').value,
                riskLevel: document.getElementById('riskLevel').value,
                lastUpdated: document.getElementById('lastUpdated').value,
                status: document.getElementById('status').value,
                category: document.getElementById('category').value,
                description: document.getElementById('description').value,
                notes: document.getElementById('notes').value,
                addedDate: currentEditId ? projects.find(p => p.id === currentEditId).addedDate : new Date().toLocaleDateString()
            };

            if (currentEditId) {
                const index = projects.findIndex(p => p.id === currentEditId);
                projects[index] = project;
                currentEditId = null;
            } else {
                projects.push(project);
            }

            renderTable();
            toggleAddForm();
            updateStats();
        }

        function editProject(id) {
            const project = projects.find(p => p.id === id);
            if (!project) return;

            currentEditId = id;
            document.getElementById('software').value = project.software;
            document.getElementById('version').value = project.version;
            document.getElementById('licenseType').value = project.licenseType;
            document.getElementById('licenseUrl').value = project.licenseUrl;
            document.getElementById('copyright').value = project.copyright;
            document.getElementById('vendor').value = project.vendor;
            document.getElementById('projectUrl').value = project.projectUrl;
            document.getElementById('usage').value = project.usage;
            document.getElementById('riskLevel').value = project.riskLevel;
            document.getElementById('lastUpdated').value = project.lastUpdated;
            document.getElementById('status').value = project.status;
            document.getElementById('category').value = project.category;
            document.getElementById('description').value = project.description;
            document.getElementById('notes').value = project.notes;

            document.getElementById('addForm').style.display = 'block';
        }

        function deleteProject(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé¡¹ç›®å—ï¼Ÿ')) {
                projects = projects.filter(p => p.id !== id);
                renderTable();
                updateStats();
            }
        }

        function getLicenseBadgeClass(license) {
            if (license.toLowerCase().includes('mit')) return 'mit';
            if (license.toLowerCase().includes('apache')) return 'apache';
            if (license.toLowerCase().includes('gpl')) return 'gpl';
            if (license.toLowerCase().includes('bsd')) return 'bsd';
            if (license.toLowerCase().includes('mozilla')) return 'mozilla';
            return '';
        }

        function getRiskBadgeClass(risk) {
            if (risk === 'High') return 'risk-high';
            if (risk === 'Medium') return 'risk-medium';
            if (risk === 'Low') return 'risk-low';
            return '';
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            projects.forEach((project, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><strong>${project.software}</strong></td>
                    <td>${project.version}</td>
                    <td><span class="license-badge ${getLicenseBadgeClass(project.licenseType)}">${project.licenseType}</span></td>
                    <td>${project.licenseUrl ? `<a href="${project.licenseUrl}" target="_blank" class="url-link">æŸ¥çœ‹è®¸å¯è¯</a>` : ''}</td>
                    <td>${project.copyright}</td>
                    <td>${project.vendor}</td>
                    <td>${project.projectUrl ? `<a href="${project.projectUrl}" target="_blank" class="url-link">é¡¹ç›®åœ°å€</a>` : ''}</td>
                    <td>${project.usage}</td>
                    <td>${project.riskLevel ? `<span class="license-badge ${getRiskBadgeClass(project.riskLevel)}">${project.riskLevel}</span>` : ''}</td>
                    <td>${project.lastUpdated}</td>
                    <td>${project.status}</td>
                    <td>${project.category}</td>
                    <td>${project.description}</td>
                    <td>${project.notes}</td>
                    <td>
                        <button onclick="editProject(${project.id})" style="background: #17a2b8; margin-right: 5px; padding: 5px 10px; font-size: 12px;">ç¼–è¾‘</button>
                        <button onclick="deleteProject(${project.id})" style="background: #dc3545; padding: 5px 10px; font-size: 12px;">åˆ é™¤</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateStats() {
            document.getElementById('totalCount').textContent = projects.length;
            
            const uniqueLicenses = new Set(projects.map(p => p.licenseType)).size;
            document.getElementById('licenseTypes').textContent = uniqueLicenses;
            
            const highRiskCount = projects.filter(p => p.riskLevel === 'High').length;
            document.getElementById('highRiskCount').textContent = highRiskCount;
            
            const activeProjects = projects.filter(p => p.status === 'Active').length;
            document.getElementById('activeProjects').textContent = activeProjects;
        }

        function filterTable() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const rows = document.querySelectorAll('#tableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        function importSampleData() {
            const sampleProjects = [
                {
                    id: 1,
                    software: 'React',
                    version: '18.2.0',
                    licenseType: 'MIT',
                    licenseUrl: 'https://github.com/facebook/react/blob/main/LICENSE',
                    copyright: 'Copyright (c) Meta Platforms, Inc.',
                    vendor: 'Meta (Facebook)',
                    projectUrl: 'https://github.com/facebook/react',
                    usage: 'Direct Dependency',
                    riskLevel: 'Low',
                    lastUpdated: '2023-06-14',
                    status: 'Active',
                    category: 'Framework',
                    description: 'JavaScriptåº“ï¼Œç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢',
                    notes: 'ä¸»è¦å‰ç«¯æ¡†æ¶',
                    addedDate: new Date().toLocaleDateString()
                },
                {
                    id: 2,
                    software: 'Express.js',
                    version: '4.18.2',
                    licenseType: 'MIT',
                    licenseUrl: 'https://github.com/expressjs/express/blob/master/LICENSE',
                    copyright: 'Copyright (c) 2009-2014 TJ Holowaychuk',
                    vendor: 'Express.js Team',
                    projectUrl: 'https://github.com/expressjs/express',
                    usage: 'Direct Dependency',
                    riskLevel: 'Low',
                    lastUpdated: '2022-10-08',
                    status: 'Active',
                    category: 'Framework',
                    description: 'å¿«é€Ÿã€æ— çº¦æŸã€æç®€çš„Node.js Webæ¡†æ¶',
                    notes: 'åç«¯APIæ¡†æ¶',
                    addedDate: new Date().toLocaleDateString()
                },
                {
                    id: 3,
                    software: 'MySQL',
                    version: '8.0.33',
                    licenseType: 'GPL-2.0',
                    licenseUrl: 'https://github.com/mysql/mysql-server/blob/8.0/LICENSE',
                    copyright: 'Copyright (c) 2000, 2023, Oracle Corporation',
                    vendor: 'Oracle Corporation',
                    projectUrl: 'https://github.com/mysql/mysql-server',
                    usage: 'Runtime Dependency',
                    riskLevel: 'High',
                    lastUpdated: '2023-04-18',
                    status: 'Active',
                    category: 'Database',
                    description: 'å¼€æºå…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ',
                    notes: 'å•†ä¸šä½¿ç”¨éœ€æ³¨æ„GPLè®¸å¯è¯è¦æ±‚',
                    addedDate: new Date().toLocaleDateString()
                },
                {
                    id: 4,
                    software: 'Lodash',
                    version: '4.17.21',
                    licenseType: 'MIT',
                    licenseUrl: 'https://github.com/lodash/lodash/blob/master/LICENSE',
                    copyright: 'Copyright OpenJS Foundation',
                    vendor: 'OpenJS Foundation',
                    projectUrl: 'https://github.com/lodash/lodash',
                    usage: 'Direct Dependency',
                    riskLevel: 'Low',
                    lastUpdated: '2021-02-20',
                    status: 'Maintenance',
                    category: 'Library',
                    description: 'ç°ä»£JavaScriptå®ç”¨å·¥å…·åº“',
                    notes: 'æä¾›æ¨¡å—åŒ–ã€æ€§èƒ½å’Œé¢å¤–åŠŸèƒ½',
                    addedDate: new Date().toLocaleDateString()
                }
            ];

            projects = [...projects, ...sampleProjects];
            renderTable();
            updateStats();
            alert('ç¤ºä¾‹æ•°æ®å·²åŠ è½½ï¼');
        }

        function exportToExcel() {
            const headers = [
                'No', 'Software', 'Version', 'License Type', 'License URL', 'Copyright',
                'Vendor/Author', 'Project URL', 'Usage', 'Risk Level', 'Last Updated',
                'Status', 'Category', 'Description', 'Notes', 'Added Date'
            ];

            let csvContent = 'data:text/csv;charset=utf-8,\uFEFF';
            csvContent += headers.join(',') + '\n';

            projects.forEach((project, index) => {
                const row = [
                    index + 1,
                    `"${project.software}"`,
                    `"${project.version}"`,
                    `"${project.licenseType}"`,
                    `"${project.licenseUrl}"`,
                    `"${project.copyright}"`,
                    `"${project.vendor}"`,
                    `"${project.projectUrl}"`,
                    `"${project.usage}"`,
                    `"${project.riskLevel}"`,
                    `"${project.lastUpdated}"`,
                    `"${project.status}"`,
                    `"${project.category}"`,
                    `"${project.description}"`,
                    `"${project.notes}"`,
                    `"${project.addedDate}"`
                ];
                csvContent += row.join(',') + '\n';
            });

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', `å¼€æºåè®®ç»Ÿè®¡è¡¨_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // åˆå§‹åŒ–
        renderTable();
        updateStats();
    </script>
</body>
</html>